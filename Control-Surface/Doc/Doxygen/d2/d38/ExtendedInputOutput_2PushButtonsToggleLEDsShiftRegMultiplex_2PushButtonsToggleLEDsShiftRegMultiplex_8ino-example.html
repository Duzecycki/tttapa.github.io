<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: ExtendedInputOutput/PushButtonsToggleLEDsShiftRegMultiplex/PushButtonsToggleLEDsShiftRegMultiplex.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" async="async" src="/MathJax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Surface
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d2/d38/ExtendedInputOutput_2PushButtonsToggleLEDsShiftRegMultiplex_2PushButtonsToggleLEDsShiftRegMultiplex_8ino-example.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ExtendedInputOutput/PushButtonsToggleLEDsShiftRegMultiplex/PushButtonsToggleLEDsShiftRegMultiplex.ino</div>  </div>
</div><!--header-->
<div class="contents">
<p>This example demonstrates the use of push buttons and <a class="el" href="../../d2/d1b/classLEDs.html" title="A class for collections of LEDs that can display ranges.">LEDs</a> and how to use shift registers and analog multiplexers to save pins.<br  />
<br  />
 <br  />
Connections: <br  />
</p><ul>
<li>10: 74HC595 ST_CP</li>
<li>12: 74HC595 DS</li>
<li>13: 74HC595 SH_CP</li>
<li>18: 74HC4067 A (COM OUT/IN)</li>
<li>19: 74HC4067 S0</li>
<li>20: 74HC4067 S1</li>
<li>21: 74HC4067 S2</li>
<li>22: 74HC4067 S3</li>
</ul>
<p>Connect 16 momentary push buttons between the input pins of the multiplexer and ground. <br  />
The internal pull-up resistor for the buttons will be enabled automatically, so no external resistors are necessary.</p>
<p>Connect 16 <a class="el" href="../../d2/d1b/classLEDs.html" title="A class for collections of LEDs that can display ranges.">LEDs</a> (and series resistors) between the eight outputs of the two shift registers and ground.</p>
<p>Remember to connect the enable pins of both the multiplexer and the shift register to ground in order to enable them. <br  />
Connect the serial data output of the first shift register (QH' or Q7S) to the serial input of the second shift register.</p>
<p>Pressing the first button will turn on the first LED. Pressing it again will turn it off again. Pressing the second button will turn on the second LED. Pressing it again will turn it off again, and so on.</p>
<p>Written by PieterP, 2018-08-28 <a href="https://github.com/tttapa/Control-Surface">https://github.com/tttapa/Control-Surface</a></p>
<div class="fragment"><div class="line"> </div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span> <span class="comment">// Include the Control Surface library.</span></div><div class="line"> </div><div class="line"><span class="comment">/* Instantiate a multiplexer with three address lines. */</span></div><div class="line"><a name="_a0"></a><a class="code" href="../../d7/d8d/classAnalogMultiplex.html">CD74HC4067</a> mux = { 18, {19, 20, 21, 22} };</div><div class="line"> </div><div class="line"><span class="comment">/* The number of buttons and LEDs */</span></div><div class="line">constexpr <span class="keywordtype">size_t</span> n = 16;</div><div class="line"> </div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> latchPin = 10;  <span class="comment">// Pin connected to ST_CP of 74HC595</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> dataPin  = 12;  <span class="comment">// Pin connected to DS of 74HC595</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> clockPin = 13;  <span class="comment">// Pin connected to SH_CP of 74HC595</span></div><div class="line"> </div><div class="line"><span class="comment">/* Instantiate a shift registers on the correct pins, most significant bit</span></div><div class="line"><span class="comment"> * first, and a total of 16 outputs (two eight-bit registers). */</span></div><div class="line"><a name="_a1"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html">ShiftRegisterOut&lt;n&gt;</a> sreg = { dataPin, clockPin, latchPin, MSBFIRST };</div><div class="line"> </div><div class="line"><span class="comment">/* Instantiate the momentary push buttons.</span></div><div class="line"><span class="comment"> * It generates an array of Buttons on pins:</span></div><div class="line"><span class="comment"> * { mux.pin(0), mux.pin(1) ... mux.pin(15) } */</span></div><div class="line"><span class="keyword">auto</span> buttons = generateIncrementalArray&lt;Button, n&gt;(mux.<a name="a2"></a><a class="code" href="../../de/d4e/classExtendedIOElement.html#a163cffb9da0f3b7fdcb3c49b58393c03">pin</a>(0));</div><div class="line"> </div><div class="line"><span class="keywordtype">void</span> setup() { <span class="comment">/* Initialize everything. */</span></div><div class="line">  mux.<a name="a3"></a><a class="code" href="../../d7/d8d/classAnalogMultiplex.html#a17e37b634c36f15c11fea3eeed0ba4f7">begin</a>();</div><div class="line">  sreg.<a name="a4"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html#a8f455acd59765b9b528215f427ff584b">begin</a>();</div><div class="line">  <span class="keywordflow">for</span> (<a name="_a5"></a><a class="code" href="../../d1/d19/classButton.html">Button</a> &amp;button : buttons)</div><div class="line">    button.begin();</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="keywordtype">void</span> loop() { <span class="comment">/* Check if a button is pressed, if so toggle the LED. */</span></div><div class="line">  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; n; ++i)</div><div class="line">    <span class="keywordflow">if</span> (buttons[i].getState() == <a name="a6"></a><a class="code" href="../../d1/d19/classButton.html#ae15938c6b06f6bbf909314f987938fd6ae322e4070b093611d60f42872eb008cf">Button::Falling</a>)</div><div class="line">      sreg.<a name="a7"></a><a class="code" href="../../d8/db4/classShiftRegisterOutBase.html#a9f87915364296d5ee654f4ae3bed8e3d">digitalWrite</a>(i, !sreg.<a name="a8"></a><a class="code" href="../../d8/db4/classShiftRegisterOutBase.html#a8fc372c4de18bf3f15ff4e5eb357a38c">digitalRead</a>(i));</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassShiftRegisterOut_html"><div class="ttname"><a href="../../d1/d5c/classShiftRegisterOut.html">ShiftRegisterOut</a></div><div class="ttdoc">A class for serial-in/parallel-out shift registers, like the 74HC595.</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db4/ShiftRegisterOut_8hpp_source.html#l00016">ShiftRegisterOut.hpp:16</a></div></div>
<div class="ttc" id="aclassButton_html_ae15938c6b06f6bbf909314f987938fd6ae322e4070b093611d60f42872eb008cf"><div class="ttname"><a href="../../d1/d19/classButton.html#ae15938c6b06f6bbf909314f987938fd6ae322e4070b093611d60f42872eb008cf">Button::Falling</a></div><div class="ttdoc">Input went from high to high (1,1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db3/Button_8hpp_source.html#l00053">Button.hpp:53</a></div></div>
<div class="ttc" id="aclassButton_html"><div class="ttname"><a href="../../d1/d19/classButton.html">Button</a></div><div class="ttdoc">A class for reading and debouncing buttons and switches.</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db3/Button_8hpp_source.html#l00011">Button.hpp:11</a></div></div>
<div class="ttc" id="aControl__Surface_8h_html"><div class="ttname"><a href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a></div><div class="ttdoc">The main header file that includes all Control-Surface header files.</div></div>
<div class="ttc" id="aclassShiftRegisterOut_html_a8f455acd59765b9b528215f427ff584b"><div class="ttname"><a href="../../d1/d5c/classShiftRegisterOut.html#a8f455acd59765b9b528215f427ff584b">ShiftRegisterOut::begin</a></div><div class="ttdeci">void begin() override</div><div class="ttdoc">Initialize the shift register.</div></div>
<div class="ttc" id="aclassAnalogMultiplex_html"><div class="ttname"><a href="../../d7/d8d/classAnalogMultiplex.html">AnalogMultiplex</a></div><div class="ttdoc">A class for reading multiplexed analog inputs.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/def/AnalogMultiplex_8hpp_source.html#l00023">AnalogMultiplex.hpp:23</a></div></div>
<div class="ttc" id="aclassAnalogMultiplex_html_a17e37b634c36f15c11fea3eeed0ba4f7"><div class="ttname"><a href="../../d7/d8d/classAnalogMultiplex.html#a17e37b634c36f15c11fea3eeed0ba4f7">AnalogMultiplex::begin</a></div><div class="ttdeci">void begin() override</div><div class="ttdoc">Initialize the multiplexer: set the pin mode of the address pins and the enable pin to output mode.</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/def/AnalogMultiplex_8hpp_source.html#l00176">AnalogMultiplex.hpp:176</a></div></div>
<div class="ttc" id="aclassExtendedIOElement_html_a163cffb9da0f3b7fdcb3c49b58393c03"><div class="ttname"><a href="../../de/d4e/classExtendedIOElement.html#a163cffb9da0f3b7fdcb3c49b58393c03">ExtendedIOElement::pin</a></div><div class="ttdeci">pin_t pin(pin_t pin) const</div><div class="ttdoc">Get the extended IO pin number of a given physical pin of this extended IO element.</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d1f/ExtendedIOElement_8cpp_source.html#l00024">ExtendedIOElement.cpp:24</a></div></div>
<div class="ttc" id="aclassShiftRegisterOutBase_html_a8fc372c4de18bf3f15ff4e5eb357a38c"><div class="ttname"><a href="../../d8/db4/classShiftRegisterOutBase.html#a8fc372c4de18bf3f15ff4e5eb357a38c">ShiftRegisterOutBase::digitalRead</a></div><div class="ttdeci">int digitalRead(pin_t pin) override</div><div class="ttdoc">Get the current state of a given output pin.</div></div>
<div class="ttc" id="aclassShiftRegisterOutBase_html_a9f87915364296d5ee654f4ae3bed8e3d"><div class="ttname"><a href="../../d8/db4/classShiftRegisterOutBase.html#a9f87915364296d5ee654f4ae3bed8e3d">ShiftRegisterOutBase::digitalWrite</a></div><div class="ttdeci">void digitalWrite(pin_t pin, uint8_t val) override</div><div class="ttdoc">Set the state of a given output pin.</div></div>
<div class="ttc" id="aDef_8hpp_html_a5dac1481c2337a983c60f5f2b9c704ef"><div class="ttname"><a href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a></div><div class="ttdeci">uint16_t pin_t</div><div class="ttdoc">The type for Arduino pins (and ExtendedIOElement pins).</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d4e/Def_8hpp_source.html#l00014">Def.hpp:14</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
