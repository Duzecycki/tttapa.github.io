<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: PushButtonsToggleLEDsShiftRegMultiplex.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" async="async" src="../../../MathJax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Surface
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('da/d88/PushButtonsToggleLEDsShiftRegMultiplex_8ino-example.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PushButtonsToggleLEDsShiftRegMultiplex.ino</div>  </div>
</div><!--header-->
<div class="contents">
<p class="">This example demonstrates the use of push buttons and <a class="el" href="../../d2/d1b/classLEDs.html">LEDs</a> and how to use shift registers and analog multiplexers to save pins. <br />
 Connections: <br />
</p><ul>
<li>10: 74HC595 ST_CP</li>
<li>12: 74HC595 DS</li>
<li>13: 74HC595 SH_CP</li>
<li>18: 74HC4067 A (COM OUT/IN)</li>
<li>19: 74HC4067 S0</li>
<li>20: 74HC4067 S1</li>
<li>21: 74HC4067 S2</li>
<li>22: 74HC4067 S3</li>
</ul>
<p class="">Connect 16 momentary push buttons between the input pins of the multiplexer and ground. <br />
The internal pull-up resistor for the buttons will be enabled automatically, so no external resistors are necessary.</p>
<p class="">Connect 16 <a class="el" href="../../d2/d1b/classLEDs.html">LEDs</a> (and series resistors) between the eight outputs of the two shift registers and ground.</p>
<p class="">Remember to connect the enable pins of both the multiplexer and the shift register to ground in order to enable them. <br />
Connect the serial data output of the first shift register (QH' or Q7S) to the serial input of the second shift register.</p>
<p class="">Pressing the first button will turn on the first LED. Pressing it again will turn it off again. Pressing the second button will turn on the second LED. Pressing it again will turn it off again, and so on.</p>
<p class="">Written by PieterP, 2018-08-28 <a href="https://github.com/tttapa/Control-Surface">https://github.com/tttapa/Control-Surface</a></p>
<div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span> <span class="comment">// Include the Control Surface library.</span></div><div class="line"></div><div class="line">constexpr <span class="keywordtype">size_t</span> n = 16;</div><div class="line"></div><div class="line"><span class="comment">/* Instantiate a multiplexer with three address lines. */</span></div><div class="line"><a name="_a0"></a><a class="code" href="../../d7/d8d/classAnalogMultiplex.html">CD74HC4067</a> mux = { 18, {19, 20, 21, 22} };</div><div class="line"></div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> latchPin = 10;  <span class="comment">// Pin connected to ST_CP of 74HC595</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> dataPin  = 12;  <span class="comment">// Pin connected to DS of 74HC595</span></div><div class="line"><span class="keyword">const</span> <a class="code" href="../../d0/d4e/Def_8hpp.html#a5dac1481c2337a983c60f5f2b9c704ef">pin_t</a> clockPin = 13;  <span class="comment">// Pin connected to SH_CP of 74HC595</span></div><div class="line"></div><div class="line"><a name="_a1"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html">ShiftRegisterOut</a> sreg = { dataPin, clockPin, latchPin, MSBFIRST, n };</div><div class="line"></div><div class="line"><span class="comment">/* Instantiate the momentary push buttons.</span></div><div class="line"><span class="comment"> * It generates an array of Buttons on pins:</span></div><div class="line"><span class="comment"> * { mux.pin(0), mux.pin(1) ... mux.pin(15) } */</span></div><div class="line"><span class="keyword">auto</span> buttons = generateArray&lt;Button, n&gt;(mux.<a name="a2"></a><a class="code" href="../../de/d4e/classExtendedIOElement.html#a163cffb9da0f3b7fdcb3c49b58393c03">pin</a>(0));</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> setup() { <span class="comment">/* Initialize everything. */</span></div><div class="line">  mux.<a name="a3"></a><a class="code" href="../../d7/d8d/classAnalogMultiplex.html#a17e37b634c36f15c11fea3eeed0ba4f7">begin</a>();</div><div class="line">  sreg.<a name="a4"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html#aad43d2929f3c9abaca3b2c001bd51166">begin</a>();</div><div class="line">  <span class="keywordflow">for</span> (<a name="_a5"></a><a class="code" href="../../d1/d19/classButton.html">Button</a> &amp;button : buttons)</div><div class="line">    button.begin();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> loop() { <span class="comment">/* Check if a button is pressed, if so toggle the LED. */</span></div><div class="line">  <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; n; i++)</div><div class="line">    <span class="keywordflow">if</span> (buttons[i].getState() == <a name="a6"></a><a class="code" href="../../d1/d19/classButton.html#ae15938c6b06f6bbf909314f987938fd6ae322e4070b093611d60f42872eb008cf">Button::Falling</a>)</div><div class="line">      sreg.<a name="a7"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html#a55fa638e62920412df1c8faaa91f54c4">digitalWrite</a>(i, !sreg.<a name="a8"></a><a class="code" href="../../d1/d5c/classShiftRegisterOut.html#af38cab300d3fb838e21a42f90902343d">digitalRead</a>(i));</div><div class="line">}</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
